name: Build Project with python-rtmidi

on:
  push:
    branches: [ "main" ]
  pull_request:

jobs:
  build:
    name: Build and Test on Ubuntu
    runs-on: ubuntu-latest  # Must use Linux for ALSA

    steps:
      - name: Checkout your project code
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'

      - name: 1. Install Linux dependencies for python-rtmidi
        # This is the most important step.
        # It installs the C++ compiler and ALSA development libraries.
        run: |
          sudo apt-get update
          sudo apt-get install -y build-essential libasound2-dev

      - name: 2. Install your project's dependencies
        # When pip gets to 'python-rtmidi', it will now
        # find the headers from 'libasound2-dev' and
        # build the package from source successfully.
        run: |
          pip install -r requirements.txt
          # or `pip install .` if your project is a package

      - name: 3. Verify rtmidi installation
        run: |
          python -c "import rtmidi; print('Successfully built and imported python-rtmidi!')"

      # - name: Run your project's tests
      #   run: |
      #     pytest